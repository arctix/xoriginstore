/*! xoriginstore 2016-11-02 */
!function(){function a(a){var i,k=a||{};this.initialized=!1;try{this.mode=k.mode||g,i=k.receiverUrl||window.location.origin,f=d(i),e=k.senderOrigin||window.top.location.origin}catch(a){throw window.top.location.replace(window.self.location),console.log(a),new Error("Sender and Receiver not in the same TLD!",a)}var l=[];if(j.forEach(function(a){0===f.search(a)&&l.push(a),0===e.search(a)&&l.push(a)}),2!=l.length)throw new Error("Invalid origins "+[e,f]);if(window.addEventListener("message",b,!1),this.mode===h){var m="crossOriginHelperFrame",n=c(m,i);this.targetFrame=n.contentWindow;var o=this;n.addEventListener("load",function(){o.initialized=!0})}else this.initialized=!0}function b(a){if(a.origin!==e&&a.origin!==f)return void console.error("Invalid origin - ",a.origin);if("set"===a.data.action)sessionStorage.setItem(a.data.key,a.data.value),"function"==typeof i.setItem&&i.setItem.call(this,a.data.key,a.data.value);else if("get"===a.data.action){var b=sessionStorage.getItem(a.data.key);a.source.postMessage({action:"return",key:a.data.key,value:b,id:a.data.id,mode:h},a.origin)}else"remove"===a.data.action?sessionStorage.removeItem(a.data.key):"clear"===a.data.action?sessionStorage.clear():"return"===a.data.action&&("function"==typeof i[a.data.id]?(i[a.data.id].call(this,a.data.value),delete i[a.data.id]):console.error("Callback function not found for "+a.data.id))}function c(a,b){var c=document.createElement("iframe");return c.src=b,c.id=a,c.height=0,c.width=0,document.body.appendChild(c)}function d(a){var b=document.createElement("a");return b.href=a,b.origin?b.origin:b.protocol+"//"+b.hostname+(b.port&&"80"!==b.port&&"443"!==b.port?":"+b.port:"")}var e,f,g="RECEIVER",h="SENDER",i={},j=["^http://[a-z0-9-.]+.example.com$","^http://localhost:9876$"];a.prototype.constructor=a,a.prototype.setItem=function(a,b){if(!this.initialized)throw new Error("Not initialized!");this.targetFrame.postMessage({action:"set",key:a,value:b},f)},a.prototype.getItem=function(a,b){if(!this.initialized)throw new Error("Not initialized!");var c=Math.floor(1e4*Math.random());i[c]=b,this.targetFrame.postMessage({action:"get",key:a,id:c},f)},a.prototype.removeItem=function(a){if(!this.initialized)throw new Error("Not initialized!");this.targetFrame.postMessage({action:"remove",key:a},f)},a.prototype.clear=function(){if(!this.initialized)throw new Error("Not initialized!");this.targetFrame.postMessage({action:"clear"},f)},a.prototype.onSetItem=function(a){i.setItem=a},a.MODE_RECEIVER=g,a.MODE_SENDER=h,window.XOriginSessionStore=a}();